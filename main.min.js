const _0x39fd4f=_0x3bc5;!function(t,e){const s=_0x3bc5,i=_0x5052();for(;;)try{if(894103===parseInt(s(482))/1*(-parseInt(s(567))/2)+-parseInt(s(528))/3+parseInt(s(564))/4+-parseInt(s(627))/5+-parseInt(s(536))/6*(-parseInt(s(628))/7)+parseInt(s(514))/8+parseInt(s(634))/9*(parseInt(s(595))/10))break;i.push(i.shift())}catch(t){i.push(i.shift())}}();import*as _0x3e9008 from"https://cdn.jsdelivr.net/npm/three@0.118/build/three.module.js";import{FBXLoader}from"https://cdn.jsdelivr.net/npm/three@0.118.1/examples/jsm/loaders/FBXLoader.js";import{OrbitControls}from"https://cdn.jsdelivr.net/npm/three@0.118/examples/jsm/controls/OrbitControls.js";import{ImprovedNoise}from"https://cdn.jsdelivr.net/npm/three@0.118/examples/jsm/math/ImprovedNoise.js";class BasicCharacterControllerProxy{constructor(t){this[_0x3bc5(569)]=t}get animations(){return this[_0x3bc5(569)]}}class BasicCharacterController{constructor(t){const e=_0x3bc5;this[e(586)]=t,this[e(534)]=new(_0x3e9008[e(618)])(-5e-4,-1e-4,-5),this[e(575)]=new(_0x3e9008[e(618)])(1,.25,50),this[e(620)]=new(_0x3e9008[e(618)])(0,0,0),this[e(569)]={},this._input=new BasicCharacterControllerInput,this[e(556)]=new CharacterFSM(new BasicCharacterControllerProxy(this[e(569)])),this._LoadModels()}_LoadModels(){const t=_0x3bc5,e=new FBXLoader;e[t(591)]("./resources/personajeHomero/"),e[t(602)](t(571),(e=>{const s=t;e[s(519)][s(607)](.1),e[s(507)]((t=>{t[s(526)]=!0})),this[s(609)]=e,this[s(586)][s(520)].add(this[s(609)]),this[s(484)]=new(_0x3e9008[s(584)])(this[s(609)]),this._manager=new(_0x3e9008[s(583)]),this[s(613)][s(509)]=()=>{const t=s;this._stateMachine[t(551)](t(580))};const i=(t,e)=>{const i=s,n=e[i(548)][0],o=this[i(484)].clipAction(n);this._animations[t]={clip:n,action:o}},n=new FBXLoader(this[s(613)]);n.setPath("./resources/personajeHomero/"),n[s(602)](s(515),(t=>{i("walk",t)})),n[s(602)]("run.fbx",(t=>{i(s(635),t)})),n[s(602)]("idle.fbx",(t=>{i("idle",t)}))}))}[_0x39fd4f(543)](t){const e=_0x39fd4f;if(!this._target)return;this[e(556)][e(543)](t,this[e(496)]);const s=this._velocity,i=new(_0x3e9008[e(618)])(s.x*this[e(534)].x,s.y*this[e(534)].y,s.z*this._deceleration.z);i[e(481)](t),i.z=Math[e(508)](i.z)*Math.min(Math.abs(i.z),Math[e(582)](s.z)),s.add(i);const n=this[e(609)],o=new(_0x3e9008[e(619)]),a=new(_0x3e9008[e(618)]),r=n[e(525)][e(581)](),h=this[e(575)].clone();this[e(496)][e(501)].shift&&h.multiplyScalar(3),this._input[e(501)].forward&&(s.z+=h.z*t),this._input[e(501)][e(585)]&&(s.z-=h.z*t),this[e(496)][e(501)][e(565)]&&(a.set(0,1,0),o.setFromAxisAngle(a,4*Math.PI*t*this[e(575)].y),r[e(480)](o)),this[e(496)][e(501)][e(487)]&&(a[e(560)](0,1,0),o[e(512)](a,4*-Math.PI*t*this[e(575)].y),r.multiply(o)),n[e(525)][e(518)](r);const c=new _0x3e9008.Vector3;c[e(518)](n.position);const d=new(_0x3e9008[e(618)])(0,0,1);d[e(540)](n[e(525)]),d[e(494)]();const _=new(_0x3e9008[e(618)])(1,0,0);_.applyQuaternion(n.quaternion),_[e(494)](),_[e(481)](s.x*t),d[e(481)](s.z*t),n.position[e(517)](d),n[e(622)].add(_);const f=new(_0x3e9008[e(490)])(n[e(622)][e(581)]().add(new(_0x3e9008[e(618)])(0,10,0)),new(_0x3e9008[e(618)])(0,-1,0)).intersectObjects(this[e(586)][e(520)][e(561)]);if(f[e(558)]>0){const t=f[0][e(541)].y;n[e(622)].y=t+1}c[e(518)](n[e(622)]),this._mixer&&this[e(484)][e(554)](t)}}class BasicCharacterControllerInput{constructor(){const t=_0x39fd4f;this[t(501)]={forward:!1,backward:!1,left:!1,right:!1,space:!1,shift:!1},document[t(523)](t(599),(e=>this[t(546)](e)),!1),document[t(523)](t(476),(e=>this[t(588)](e)),!1),this[t(616)]()}[_0x39fd4f(616)](){const t=_0x39fd4f,e=(t,e)=>{this[_0x3bc5(501)][t]=e},s=document[t(471)]("button-up");s&&(s[t(523)](t(577),(()=>e(t(574),!0))),s[t(523)]("mouseup",(()=>e(t(574),!1))),s[t(523)](t(473),(()=>e("forward",!1))),s[t(523)]("touchstart",(()=>e("forward",!0)),!1),s[t(523)](t(516),(()=>e(t(574),!1)),!1));const i=document.getElementById(t(614));i&&(i.addEventListener("mousedown",(()=>e("left",!0))),i[t(523)](t(488),(()=>e(t(565),!1))),i[t(523)](t(473),(()=>e(t(565),!1))),i[t(523)](t(566),(()=>e(t(565),!0)),!1),i[t(523)]("touchend",(()=>e(t(565),!1)),!1));const n=document[t(471)](t(530));n&&(n[t(523)](t(577),(()=>e(t(487),!0))),n[t(523)]("mouseup",(()=>e(t(487),!1))),n[t(523)]("mouseleave",(()=>e(t(487),!1))),n[t(523)](t(566),(()=>e("right",!0)),!1),n.addEventListener(t(516),(()=>e(t(487),!1)),!1));const o=document[t(471)]("button-down");o&&(o[t(523)](t(577),(()=>e(t(585),!0))),o[t(523)](t(488),(()=>e(t(585),!1))),o.addEventListener(t(473),(()=>e(t(585),!1))),o[t(523)](t(566),(()=>e("backward",!0)),!1),o[t(523)](t(516),(()=>e(t(585),!1)),!1))}[_0x39fd4f(546)](t){const e=_0x39fd4f;switch(t[e(538)]){case 87:this[e(501)][e(574)]=!0;break;case 65:this._keys[e(565)]=!0;break;case 83:this._keys[e(585)]=!0;break;case 68:this._keys[e(487)]=!0;break;case 32:this[e(501)].space=!0;break;case 16:this._keys[e(631)]=!0}}[_0x39fd4f(588)](t){const e=_0x39fd4f;switch(t[e(538)]){case 87:this._keys[e(574)]=!1;break;case 65:this[e(501)].left=!1;break;case 83:this._keys.backward=!1;break;case 68:this[e(501)][e(487)]=!1;break;case 32:this._keys.space=!1;break;case 16:this._keys[e(631)]=!1}}}class FiniteStateMachine{constructor(){const t=_0x39fd4f;this._states={},this[t(527)]=null}[_0x39fd4f(617)](t,e){this[_0x39fd4f(590)][t]=e}[_0x39fd4f(551)](t){const e=_0x39fd4f,s=this[e(527)];if(s){if(s[e(578)]==t)return;s[e(562)]()}const i=new this._states[t](this);this[e(527)]=i,i[e(537)](s)}[_0x39fd4f(543)](t,e){const s=_0x39fd4f;this[s(527)]&&this[s(527)][s(543)](t,e)}}class CharacterFSM extends FiniteStateMachine{constructor(t){const e=_0x39fd4f;super(),this._proxy=t,this[e(522)]()}[_0x39fd4f(522)](){const t=_0x39fd4f;this[t(617)](t(580),IdleState),this._AddState(t(474),WalkState),this[t(617)](t(635),RunState)}}class State{constructor(t){this[_0x39fd4f(608)]=t}[_0x39fd4f(537)](){}[_0x39fd4f(562)](){}[_0x39fd4f(543)](){}}function _0x3bc5(t,e){const s=_0x5052();return(_0x3bc5=function(t,e){return s[t-=471]})(t,e)}class WalkState extends State{constructor(t){super(t)}get[_0x39fd4f(578)](){return"walk"}Enter(t){const e=_0x39fd4f,s=this._parent[e(495)][e(569)][e(474)][e(606)];if(t){const i=this[e(608)]._proxy[e(569)][t[e(578)]][e(606)];if(s[e(604)]=!0,t[e(578)]==e(635)){const t=s[e(513)]().duration/i[e(513)]()[e(544)];s[e(542)]=i[e(542)]*t}else s[e(542)]=0,s[e(497)](1),s.setEffectiveWeight(1);s[e(553)](i,.5,!0),s[e(477)]()}else s[e(477)]()}[_0x39fd4f(562)](){}Update(t,e){const s=_0x39fd4f;e[s(501)][s(574)]||e[s(501)].backward?e[s(501)][s(631)]&&this[s(608)][s(551)](s(635)):this._parent[s(551)](s(580))}}class RunState extends State{constructor(t){super(t)}get[_0x39fd4f(578)](){return"run"}Enter(t){const e=_0x39fd4f,s=this[e(608)][e(495)][e(569)].run[e(606)];if(t){const i=this[e(608)]._proxy[e(569)][t[e(578)]].action;if(s[e(604)]=!0,"walk"==t[e(578)]){const t=s.getClip()[e(544)]/i[e(513)]()[e(544)];s[e(542)]=i[e(542)]*t}else s[e(542)]=0,s[e(497)](1),s.setEffectiveWeight(1);s.crossFadeFrom(i,.5,!0),s[e(477)]()}else s[e(477)]()}[_0x39fd4f(562)](){}[_0x39fd4f(543)](t,e){const s=_0x39fd4f;e[s(501)][s(574)]||e[s(501)][s(585)]?!e[s(501)][s(631)]&&this[s(608)].SetState(s(474)):this[s(608)].SetState(s(580))}}class IdleState extends State{constructor(t){super(t)}get Name(){return _0x39fd4f(580)}[_0x39fd4f(537)](t){const e=_0x39fd4f,s=this[e(608)][e(495)]._animations[e(580)][e(606)];if(t){const i=this._parent[e(495)]._animations[t[e(578)]][e(606)];s[e(542)]=0,s[e(604)]=!0,s.setEffectiveTimeScale(1),s[e(557)](1),s[e(553)](i,.5,!0),s[e(477)]()}else s.play()}[_0x39fd4f(562)](){}[_0x39fd4f(543)](t,e){const s=_0x39fd4f;(e[s(501)][s(574)]||e._keys[s(585)])&&this[s(608)][s(551)](s(474))}}class CharacterControllerDemo{constructor(){this._Initialize()}[_0x39fd4f(472)](){const t=_0x39fd4f;this[t(568)]=new(_0x3e9008[t(555)])({antialias:!0}),this[t(568)][t(598)]=_0x3e9008[t(621)],this._threejs[t(498)].enabled=!0,this[t(568)][t(498)].type=_0x3e9008[t(549)],this[t(568)].setPixelRatio(window[t(593)]),this[t(568)][t(506)](window[t(483)],window[t(511)]),document[t(632)][t(500)](this._threejs[t(559)]),window[t(523)](t(596),(()=>{this[t(489)]()}),!1);this[t(623)]=new _0x3e9008.PerspectiveCamera(60,1920/1080,1,1e3),this[t(623)][t(622)][t(560)](60,50,40),this[t(505)]=new(_0x3e9008[t(547)]),this[t(505)].background=new(_0x3e9008[t(600)])(8900331);let e=new(_0x3e9008[t(625)])(16777215,1);e[t(622)][t(560)](-100,100,100),e[t(510)][t(622)][t(560)](0,0,0),e[t(526)]=!0,e[t(492)][t(612)]=-.001,e[t(492)][t(524)][t(529)]=4096,e[t(492)][t(524)].height=4096,e[t(492)][t(535)][t(493)]=.1,e.shadow[t(535)][t(502)]=500,e[t(492)][t(535)][t(565)]=50,e.shadow[t(535)].right=-50,e[t(492)][t(535)][t(576)]=50,e[t(492)][t(535)].bottom=-50,this._scene[t(517)](e),e=new(_0x3e9008[t(570)])(16777215,.25),this[t(505)][t(517)](e);const s=new OrbitControls(this._camera,this[t(568)][t(559)]);s[t(510)].set(0,10,0),s[t(554)](),this[t(633)]=[],this[t(587)]=null,this[t(563)]=new _0x3e9008.Vector3(60,50,40),this[t(597)]=50,this[t(626)]=new Map,this[t(545)]=new(_0x3e9008[t(618)]),this[t(499)](),this._LoadAnimatedModel(),this[t(552)]()}_LoadInitialChunks(){for(let t=-2;t<=2;t++)for(let e=-2;e<=2;e++)this._AddChunk(t,e)}[_0x39fd4f(479)](t,e){const s=_0x39fd4f,i=new(_0x3e9008[s(624)])(this[s(597)],this[s(597)],50,50);i.rotateX(-Math.PI/2);const n=new ImprovedNoise;for(let o=0;o<i[s(615)][s(558)];o++){const a=i[s(615)][o],r=(a.x+t*this[s(597)])/20,h=(a.z+e*this[s(597)])/20,c=10*n[s(579)](r,h,0);a.y=c}i[s(610)]();const o=new(_0x3e9008[s(486)])({color:32768,roughness:.9,metalness:0,flatShading:!0}),a=new(_0x3e9008[s(485)])(i,o);a[s(630)]=!0,a[s(622)][s(560)](t*this[s(597)],0,e*this.chunkSize),this._scene[s(517)](a),this[s(626)][s(560)](t+","+e,a)}_LoadAnimatedModel(){const t=_0x39fd4f,e={camera:this[t(623)],scene:this[t(505)]};this[t(503)]=new BasicCharacterController(e),this[t(609)]=this[t(503)]._target}[_0x39fd4f(489)](){const t=_0x39fd4f;this[t(623)][t(572)]=window[t(483)]/window.innerHeight,this[t(623)][t(532)](),this[t(568)][t(506)](window[t(483)],window.innerHeight)}[_0x39fd4f(552)](){requestAnimationFrame((t=>{const e=_0x3bc5;null===this[e(587)]&&(this[e(587)]=t),this[e(552)](),this._threejs[e(601)](this[e(505)],this[e(623)]),this[e(594)](t-this[e(587)]),this[e(587)]=t}))}[_0x39fd4f(594)](t){const e=_0x39fd4f,s=.001*t;this[e(633)]&&this._mixers[e(629)]((t=>t[e(554)](s))),this._controls&&this[e(503)][e(543)](s),this[e(503)][e(609)]&&(this._FollowCharacter(),this[e(573)]())}[_0x39fd4f(531)](){const t=_0x39fd4f,e=this[t(503)][t(609)][t(622)].clone(),s=e[t(581)]().add(this[t(563)]);this[t(623)][t(622)][t(518)](s),this[t(623)][t(539)](e)}[_0x39fd4f(573)](){const t=_0x39fd4f,e=this[t(503)]._target[t(622)],s=Math[t(550)](e.x/this.chunkSize),i=Math[t(550)](e.z/this[t(597)]);if(s!==this._lastChunkPosition.x||i!==this[t(545)].z){this[t(545)][t(560)](s,i);const e=2;for(let n=-e;n<=e;n++)for(let o=-e;o<=e;o++){const e=s+n+","+(i+o);!this.activeChunks[t(592)](e)&&this[t(479)](s+n,i+o)}const n=4;for(const e of this[t(626)][t(636)]()){const[o,a]=e.split(",").map(Number);(Math[t(582)](o-s)>n||Math[t(582)](a-i)>n)&&(this[t(505)][t(504)](this[t(626)][t(491)](e)),this[t(626)][t(589)](e))}}}}let _APP=null;function _0x5052(){const t=["keydown","Color","render","load","DOMContentLoaded","enabled","display","action","setScalar","_parent","_target","computeVertexNormals","click","bias","_manager","button-left","vertices","_addButtonListeners","_AddState","Vector3","Quaternion","_velocity","sRGBEncoding","position","_camera","PlaneGeometry","DirectionalLight","activeChunks","4511250PHNNwP","1005193UbEUui","map","receiveShadow","shift","body","_mixers","229842YEYDeb","run","keys","getElementById","_Initialize","mouseleave","walk","style","keyup","play","none","_AddChunk","multiply","multiplyScalar","1qPNnbL","innerWidth","_mixer","Mesh","MeshStandardMaterial","right","mouseup","_OnWindowResize","Raycaster","get","shadow","near","normalize","_proxy","_input","setEffectiveTimeScale","shadowMap","_LoadInitialChunks","appendChild","_keys","far","_controls","remove","_scene","setSize","traverse","sign","onLoad","target","innerHeight","setFromAxisAngle","getClip","333160AikaJH","walk.fbx","touchend","add","copy","scale","scene",".cerrar","_Init","addEventListener","mapSize","quaternion","castShadow","_currentState","2876679hAnmEA","width","button-right","_FollowCharacter","updateProjectionMatrix",".creditos","_deceleration","camera","66UXwgQX","Enter","keyCode","lookAt","applyQuaternion","point","time","Update","duration","_lastChunkPosition","_onKeyDown","Scene","animations","PCFSoftShadowMap","floor","SetState","_RAF","crossFadeFrom","update","WebGLRenderer","_stateMachine","setEffectiveWeight","length","domElement","set","children","Exit","_cameraOffset","2755580PAmVwi","left","touchstart","1561414fhYKIG","_threejs","_animations","AmbientLight","personajeHomero.fbx","aspect","_CheckChunkLoading","forward","_acceleration","top","mousedown","Name","noise","idle","clone","abs","LoadingManager","AnimationMixer","backward","_params","_previousRAF","_onKeyUp","delete","_states","setPath","has","devicePixelRatio","_Step","480CuLdeH","resize","chunkSize","outputEncoding"];return(_0x5052=function(){return t})()}window[_0x39fd4f(523)](_0x39fd4f(603),(()=>{_APP=new CharacterControllerDemo})),document.querySelector(_0x39fd4f(521)).addEventListener(_0x39fd4f(611),(function(){const t=_0x39fd4f;document.querySelector(t(533))[t(475)][t(605)]=t(478)}));